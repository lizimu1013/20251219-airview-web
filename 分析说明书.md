# 用户需求管理网页（Vue 3）需求分析说明书 v1.0

## 1. 背景与目标
**背景**：团队需要一个轻量的“需求收集—评审—执行前管理”工具，统一入口提交需求，并对需求进行接纳、挂起、拒绝等状态流转，减少口头/IM/表格分散带来的遗漏与反复沟通。  
**目标**：
- 提供需求从提交到结论（接纳/拒绝/挂起）的可追踪闭环
- 提升需求可见性、可搜索性、可统计性
- 支持简单权限与审计，确保决策可追溯

## 2. 术语与定义
- **需求（Request）**：用户提交的功能/改进/问题修复诉求条目。
- **接纳（Accepted）**：需求通过评审，进入待排期/待实现队列（本系统不必实现完整研发流程，但需记录接纳结论与理由）。
- **挂起（Suspended）**：需求暂不处理，需记录挂起原因与复审时间/条件。
- **拒绝（Rejected）**：需求不予处理，需记录拒绝原因（可选：可替代方案/指引）。
- **状态流转（Workflow）**：需求状态变更的规则与日志。

## 3. 角色与权限
### 3.1 角色
- **提交者（Requester）**：提交/查看自己需求，补充信息，撤回（可选）。
- **评审者（Reviewer）**：对需求做接纳/挂起/拒绝决策，要求补充信息，维护标签/优先级等。
- **管理员（Admin）**：用户与角色管理、全局配置、数据导出、字典维护（标签、分类等）。

### 3.2 权限（MVP）
- 提交者：创建需求；查看/编辑自己需求（在“未决/待补充”阶段）；查看自己需求的状态与处理意见；评论补充。
- 评审者：查看全部需求；变更状态；编辑关键字段（优先级、分类、标签、负责人/评审人等）；评论；指派处理人（可选）。
- 管理员：拥有评审者全部权限 + 用户/权限配置、系统配置、导出。

> 备注：如不做登录，可先以“单租户/默认用户”模式实现；但需求说明书默认包含登录与权限。

## 4. 业务流程与状态机
### 4.1 状态定义（建议）
- **Draft（草稿）**：提交者未正式提交（可选）
- **Submitted（已提交/待评审）**
- **NeedInfo（待补充）**：评审者要求提交者补充信息
- **Accepted（已接纳）**
- **Suspended（已挂起）**
- **Rejected（已拒绝）**
- **Closed（已关闭）**：已接纳后因重复/不再需要而关闭（可选）

### 4.2 允许的状态流转（建议）
- Draft → Submitted
- Submitted ↔ NeedInfo
- Submitted/NeedInfo → Accepted | Suspended | Rejected
- Suspended → Submitted（重新进入评审）或 → Accepted/Rejected
- Accepted → Closed（可选）
- Rejected → Submitted（允许“申诉重提”，可选，需记录原因）

### 4.3 决策规则（MVP）
- 接纳/挂起/拒绝必须填写“处理意见/原因”（原因字段不可为空）
- 状态变更必须写入审计日志：操作者、时间、旧值、新值、备注
- 挂起需提供“复审时间”或“复审条件”（二选一，建议至少一个必填）

## 5. 功能需求（FR）
### 5.1 需求提交
- 提交者可创建需求，填写必填信息并提交
- 支持保存草稿（可选）
- 支持附件上传（可选，MVP可先用链接字段代替）

**必填字段（建议）**
- 标题
- 需求描述
- 期望价值/收益（Why）
- 联系方式/所属团队（若有登录可自动填充）

**可选字段（建议）**
- 分类（功能/优化/缺陷/咨询…）
- 标签（多选）
- 优先级（P0/P1/P2/P3）
- 期望上线时间/截止日期
- 相关链接（截图、工单、文档）
- 影响范围/受影响用户
- 验收标准（Acceptance Criteria）

### 5.2 需求列表与检索
- 列表展示：标题、状态、优先级、提交者、更新时间、标签
- 支持筛选：状态、优先级、分类、标签、提交者、时间范围
- 支持搜索：标题/描述关键字
- 支持排序：更新时间、创建时间、优先级（可选）

### 5.3 需求详情
- 展示需求全部字段、当前状态、处理意见
- 展示状态流转历史/审计日志
- 支持评论区：提交者与评审者沟通补充信息（支持 @ 提及可选）
- 支持编辑（受权限与状态限制）

### 5.4 评审与状态变更（核心）
- 评审者可对需求执行：
  - **接纳需求**：填写接纳意见，可设置优先级/标签/分类（若为空）
  - **挂起需求**：填写挂起原因 + 复审时间/条件
  - **拒绝需求**：填写拒绝原因（可选：建议替代方案/指引链接）
  - **要求补充信息**：切换为 NeedInfo，填写需要补充的点
- 状态变更后触发通知（见 6.2）

### 5.5 统计与看板（MVP 可简化）
- 概览卡片：总数、待评审、待补充、已接纳、已挂起、已拒绝
- 简易图表（可选）：按状态、按分类、按优先级分布；时间趋势（近30天）

### 5.6 用户与权限（若启用登录）
- 登录/退出（推荐接入企业 SSO；MVP可用账号密码/本地mock）
- 管理员可配置用户角色（提交者/评审者/管理员）
- 需求默认可见性：评审者全量可见；提交者仅看自己（可配置为全员可见）

### 5.7 导出与归档（可选）
- 支持按筛选条件导出 CSV/Excel
- 支持归档旧需求（不在默认列表展示）

## 6. 通知与协作（NFR+FR）
### 6.1 通知触发点
- 需求被评审者变更状态
- 需求被要求补充信息
- 评论被回复/提及（可选）

### 6.2 通知方式（按实现复杂度）
- 站内通知（MVP推荐）
- 邮件/企业IM Webhook（可选）

## 7. 数据与字段模型（概念模型）
### 7.1 Request（需求）
- id（唯一标识）
- title
- description（Markdown）
- status（枚举）
- category（可空）
- priority（可空）
- tags（数组）
- requesterId
- reviewerId（可空）
- decisionReason（接纳/挂起/拒绝原因，随状态变化记录到日志；主表可保留最新）
- suspendUntil / suspendCondition（挂起信息）
- createdAt / updatedAt

### 7.2 Comment（评论）
- id, requestId, authorId, content, createdAt

### 7.3 AuditLog（审计日志）
- id, requestId, actorId, actionType（status_change/edit/comment）
- fromValue/toValue（结构化）
- note
- createdAt

### 7.4 User（用户）
- id, name, email（可选）, role(s), createdAt

## 8. 页面与交互（IA）
- 登录页（可选）
- 需求列表页（默认入口）
- 新建/编辑需求页
- 需求详情页（含评论与审计）
- 评审工作台（可选：聚合“待评审/待补充”）
- 管理后台（用户/字典配置，可选）
- 统计页（可选）

## 9. 非功能需求（NFR）
- **技术栈**：Vue 3（最新稳定版）、Vite、TypeScript、Pinia、Vue Router、UI组件库（Element Plus/Naive UI等其一）
- **性能**：列表首屏 < 2s（常规网络），分页/虚拟滚动（数据量大时）
- **可用性**：关键操作二次确认（拒绝/挂起），表单必填校验清晰
- **安全**：鉴权（JWT/Session），CSRF/输入校验；审计不可篡改（至少应用层不可编辑）
- **可访问性**：基础键盘可操作、表单错误提示可读
- **兼容性**：现代浏览器（Chrome/Edge/Safari 最近2个大版本）
- **国际化**：可选（先中文）
- **可运维**：日志、错误上报（可选），环境配置（dev/staging/prod）

## 10. 约束与假设
- MVP 不覆盖完整研发流程（排期/开发/发布），只负责“需求管理与决策闭环”
- 权限模型先简化为角色级别（不做复杂组织/项目隔离）；后续可扩展“项目/空间”

## 11. MVP 范围（建议优先级）
### P0（必须）
- 需求创建/提交
- 列表筛选搜索
- 详情页 + 评论
- 接纳/挂起/拒绝/待补充 状态流转 + 审计日志
- 基础权限（提交者仅看自己；评审者看全部）

### P1（应该）
- 统计概览
- 站内通知
- 导出 CSV

### P2（可选）
- 附件上传
- 企业IM/邮件通知
- 多项目/多空间隔离

## 12. 验收标准（示例）
- 提交者提交需求后，评审者可在“待评审”列表看到并执行接纳/挂起/拒绝/待补充
- 任一状态变更会产生一条审计日志，记录操作者、时间、原因与前后状态
- 提交者在 NeedInfo 状态下可补充信息并再次提交进入评审
- 列表筛选与关键字搜索能正确命中标题与描述
